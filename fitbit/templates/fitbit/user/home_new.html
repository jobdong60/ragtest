{% extends 'user/base.html' %}

{% block title %}í™ˆ - MyHealth Partner{% endblock %}

{% block content %}
<div class="page-title">ëŒ€ì‹œë³´ë“œ</div>
<div class="page-subtitle">Fitbit ë°ì´í„° ê°œìš”</div>

{% if not request.session.user_id %}
<div class="card" style="text-align: center; padding: 60px 20px; position: relative;">
    <h2 style="color: #667eea; margin-bottom: 20px;">í™˜ì˜í•©ë‹ˆë‹¤!</h2>
    <p style="color: #666; margin-bottom: 30px;">
        Fitbit ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì—¬<br>
        ë‹¹ì‹ ì˜ í™œë™ ë°ì´í„°ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.
    </p>
    <a href="{% url 'login' %}" class="btn btn-primary">Fitbitìœ¼ë¡œ ë¡œê·¸ì¸</a>

    <!-- Admin ë¡œê·¸ì¸ ë²„íŠ¼ -->
    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef;">
        <a href="{% url 'admin_login' %}"
           style="color: #666; font-size: 14px; text-decoration: none; display: inline-block; padding: 10px 20px; border: 1px solid #ddd; border-radius: 8px; transition: all 0.3s; background: #f8f9fa;">
            ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸
        </a>
    </div>

    <style>
        a[href*="admin_login"]:hover {
            color: white !important;
            background: #e74c3c !important;
            border-color: #e74c3c !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);
        }
    </style>
</div>
{% else %}

<!-- ìš”ì•½ ì¹´ë“œ -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
    <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 12px;">
        <div style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">ì˜¤ëŠ˜ì˜ ê±¸ìŒ ìˆ˜</div>
        <div style="font-size: 32px; font-weight: 700;">
            {% if activity_data %}{{ activity_data.summary.steps|floatformat:0 }}{% else %}0{% endif %}
        </div>
        <div style="font-size: 13px; opacity: 0.8; margin-top: 5px;">ê±¸ìŒ</div>
    </div>

    <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 25px; border-radius: 12px;">
        <div style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">ì†Œëª¨ ì¹¼ë¡œë¦¬</div>
        <div style="font-size: 32px; font-weight: 700;">
            {% if activity_data %}{{ activity_data.summary.caloriesOut|floatformat:0 }}{% else %}0{% endif %}
        </div>
        <div style="font-size: 13px; opacity: 0.8; margin-top: 5px;">kcal</div>
    </div>

    <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 25px; border-radius: 12px;">
        <div style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">ì•ˆì • ì‹œ ì‹¬ë°•ìˆ˜</div>
        <div style="font-size: 32px; font-weight: 700;">
            {% if activity_data.summary.restingHeartRate %}{{ activity_data.summary.restingHeartRate }}{% else %}-{% endif %}
        </div>
        <div style="font-size: 13px; opacity: 0.8; margin-top: 5px;">bpm</div>
    </div>

    <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 25px; border-radius: 12px;">
        <div style="font-size: 14px; opacity: 0.9; margin-bottom: 5px;">ì´ë™ ê±°ë¦¬</div>
        <div style="font-size: 32px; font-weight: 700;">
            {% if activity_data %}{{ activity_data.summary.distances.0.distance|floatformat:2 }}{% else %}0{% endif %}
        </div>
        <div style="font-size: 13px; opacity: 0.8; margin-top: 5px;">km</div>
    </div>
</div>

<!-- í”„ë¡œí•„ ì •ë³´ -->
{% if profile_data %}
<div class="card">
    <div class="card-title">í”„ë¡œí•„ ì •ë³´</div>
    <div style="display: flex; align-items: center; gap: 20px;">
        <img src="{{ profile_data.user.avatar150 }}" alt="Avatar" style="width: 80px; height: 80px; border-radius: 50%; border: 3px solid #667eea;">
        <div>
            <div style="font-size: 20px; font-weight: 600; color: #333; margin-bottom: 5px;">
                {{ profile_data.user.fullName }}
            </div>
            <div style="color: #666; font-size: 14px;">
                ê°€ì…ì¼: {{ profile_data.user.memberSince }}
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- ë¹ ë¥¸ ì‘ì—… -->
<div class="card">
    <div class="card-title">ë¹ ë¥¸ ì‘ì—…</div>
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <a href="{% url 'sync_data' %}" class="btn btn-success">ë°ì´í„° ë™ê¸°í™”</a>
        <a href="{% url 'dashboard' %}" class="btn btn-primary">ìƒì„¸ ëŒ€ì‹œë³´ë“œ</a>
        <a href="{% url 'subjects' %}" class="btn btn-secondary">ëŒ€ìƒì ë³´ê¸°</a>
    </div>
</div>

{% endif %}
{% endblock %}
